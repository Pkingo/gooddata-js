---
layout: api
title: foobar
---
<div id="doc">
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <div id="api-tabview" class="tabview">
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul class="tabs">
                                <li><a href="#api-modules" class="category">Modules</a>
                                    <ul id="api-modules" class="apis modules">
                                        <li><a href="../modules/admin.html">admin</a></li>
                                        <li><a href="../modules/config.html">config</a></li>
                                        <li><a href="../modules/DataLayer.html">DataLayer</a></li>
                                        <li><a href="../modules/execution.html">execution</a></li>
                                        <li><a href="../modules/metadata.html">metadata</a></li>
                                        <li><a href="../modules/project.html">project</a></li>
                                        <li><a href="../modules/sdk.html">sdk</a></li>
                                        <li><a href="../modules/util.html">util</a></li>
                                        <li><a href="../modules/xhr.html">xhr</a></li>
                                    </ul>
                                </li>
                                <li><a href="#api-classes" class="category">Classes</a>
                                    <ul id="api-classes" class="apis classes">
                                        <li><a href="../classes/admin.html">admin</a></li>
                                        <li><a href="../classes/config.html">config</a></li>
                                        <li><a href="../classes/DataLayer.html">DataLayer</a></li>
                                        <li><a href="../classes/execution.html">execution</a></li>
                                        <li><a href="../classes/metadata.html">metadata</a></li>
                                        <li><a href="../classes/project.html">project</a></li>
                                        <li><a href="../classes/sdk.html">sdk</a></li>
                                        <li><a href="../classes/util.html">util</a></li>
                                        <li><a href="../classes/xhr.html">xhr</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <strong>gooddata-js</strong> <span class="version">v8.1.0</span>
                        <h1 class="file-heading">File: src/user.ts</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        // Copyright (C) 2007-2017, GoodData(R) Corporation. All rights reserved.
                        import { XhrModule, ApiResponseError, ApiResponse } from &#x27;./xhr&#x27;;
                        import { ProjectModule } from &#x27;./project&#x27;;
                        
                        export class UserModule {
                            constructor(private xhr: XhrModule) {
                        
                            }
                        
                            /**
                             * Find out whether a user is logged in
                             *
                             * @return {Promise} resolves with true if user logged in, false otherwise
                             * @method isLoggedIn
                             */
                            public isLoggedIn(): Promise&lt;boolean&gt; {
                                return new Promise((resolve, reject) =&gt; {
                                    this.xhr.get(&#x27;/gdc/account/token&#x27;).then((r) =&gt; {
                                        if (r.response.ok) {
                                            resolve(true);
                                        }
                        
                                        resolve(false);
                                    }, (err: any) =&gt; {
                                        if (err.response.status === 401) {
                                            resolve(false);
                                        } else {
                                            reject(err);
                                        }
                                    });
                                });
                            }
                        
                            /**
                             * Find out whether a specified project is available to a currently logged user
                             *
                             * @method isLoggedInProject
                             * @return {Promise} resolves with true if user logged in and project available,
                             *                   resolves with false if user logged in and project not available,
                             *                   rejects if user not logged in
                             */
                            public isLoggedInProject(projectId: string) {
                                return this.getCurrentProfile().then((profile) =&gt; {
                                    return new Promise((resolve, reject) =&gt; {
                                        const projectModule = new ProjectModule(this.xhr);
                        
                                        projectModule.getProjects(profile.links.self.split(&#x27;/&#x27;)[4]).then((projects) =&gt; {
                                            if (projects.find((p: any) =&gt; p.links.self === &#x60;/gdc/projects/${projectId}&#x60;)) {
                                                resolve(true);
                                            } else {
                                                resolve(false);
                                            }
                                        }, (err: ApiResponseError) =&gt; {
                                            reject(err);
                                        });
                                    });
                                });
                            }
                        
                            /**
                             * This function provides an authentication entry point to the GD API. It is needed to authenticate
                             * by calling this function prior any other API calls. After providing valid credentials
                             * every subsequent API call in a current session will be authenticated.
                             *
                             * @method login
                             * @param {String} username
                             * @param {String} password
                             */
                            public login(username: string, password: string) {
                                return this.xhr.post(&#x27;/gdc/account/login&#x27;, {
                                    body: JSON.stringify({
                                        postUserLogin: {
                                            login: username,
                                            password,
                                            remember: 1,
                                            captcha: &#x27;&#x27;,
                                            verifyCaptcha: &#x27;&#x27;
                                        }
                                    })
                                }).then((r =&gt; r.getData()));
                            }
                        
                            /**
                             * This function provides an authentication entry point to the GD API via SSO
                             * https://help.gooddata.com/display/developer/GoodData+PGP+Single+Sign-On
                             *
                             * @method loginSso
                             * @param {String} sessionId PGP message
                             * @param {String} serverUrl
                             * @param {String} targetUrl
                             */
                            public loginSso(sessionId: string, serverUrl: string, targetUrl: string) {
                                return this.xhr.get(
                                    &#x60;/gdc/account/customerlogin?sessionId=${sessionId}&amp;serverURL=${serverUrl}&amp;targetURL=${targetUrl}&#x60;
                                );
                            }
                        
                            /**
                             * Logs out current user
                             * @method logout
                             */
                            public logout(): Promise&lt;ApiResponse | void&gt; {
                                return this.isLoggedIn().then((loggedIn: boolean): Promise&lt;ApiResponse | void&gt; =&gt; {
                                    if (loggedIn) {
                                        return this.xhr
                                            .get(&#x27;/gdc/app/account/bootstrap&#x27;)
                                            .then((result: any) =&gt; {
                                                const data = result.getData();
                                                const userUri = data.bootstrapResource.accountSetting.links.self;
                                                const userId = userUri.match(/([^\/]+)\/?$/)[1]; // eslint-disable-line no-useless-escape
                        
                                                return this.xhr.del(&#x60;/gdc/account/login/${userId}&#x60;);
                                            });
                                    }
                        
                                    return Promise.resolve();
                                }, (err: ApiResponseError) =&gt; Promise.reject(err));
                            }
                        
                            /**
                             * Gets current user&#x27;s profile
                             * @method getCurrentProfile
                             * @return {Promise} resolves with account setting object if user logged in, false otherwise
                             */
                            public getCurrentProfile() {
                                return this.xhr.get(&#x27;/gdc/account/profile/current&#x27;)
                                    .then(r =&gt; r.getData().accountSetting);
                            }
                        
                            /**
                             * Updates user&#x27;s profile settings
                             * @method updateProfileSettings
                             * @param {String} profileId - User profile identifier
                             * @param {Object} profileSetting
                             */
                            public updateProfileSettings(profileId: string, profileSetting: any): Promise&lt;ApiResponse&gt; { // TODO
                                return this.xhr.put(&#x60;/gdc/account/profile/${profileId}/settings&#x60;, {
                                    body: profileSetting
                                });
                            }
                        
                            /**
                             * Returns info about currently logged in user from bootstrap resource
                             * @method getAccountInfo
                             */
                            public getAccountInfo() {
                                return this.xhr.get(&#x27;/gdc/app/account/bootstrap&#x27;)
                                    .then((result: any) =&gt; {
                                        const { bootstrapResource } = result.getData();
                                        return {
                                            login: bootstrapResource.accountSetting.login,
                                            loginMD5: bootstrapResource.current.loginMD5,
                                            firstName: bootstrapResource.accountSetting.firstName,
                                            lastName: bootstrapResource.accountSetting.lastName,
                                            organizationName: bootstrapResource.settings.organizationName,
                                            profileUri: bootstrapResource.accountSetting.links.self
                                        };
                                    });
                            }
                        
                            /**
                             * Returns the feature flags valid for the currently logged in user.
                             * @method getFeatureFlags
                             */
                            public getFeatureFlags() {
                                return this.xhr.get(&#x27;/gdc/app/account/bootstrap&#x27;)
                                    .then(((r: any) =&gt; r.getData()))
                                    .then((result: any) =&gt; result.bootstrapResource.current.featureFlags);
                            }
                        }
                        
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

